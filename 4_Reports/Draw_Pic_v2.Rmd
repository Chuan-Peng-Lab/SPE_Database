---
title: "Draw_pic_v2"
author: "czx"
date: "`r Sys.Date()`"
output: html_document
---

```{r}
library(ggplot2)
library(dplyr)
library(purrr)
```
## 原始分类
```{r}
# 将列表转换为数据框并添加Condition列
df_combined <- bind_rows(
  map_dfr(df_Self_Stranger, ~{
    df_temp <- as.data.frame(.x)  # 将列表转换为数据框
    mutate(df_temp, Condition = "Self-Stranger")  # 添加Condition列
  }),
  
  map_dfr(df_Self_Familiar, ~{
    df_temp <- as.data.frame(.x)  # 将列表转换为数据框
    mutate(df_temp, Condition = "Self-Familiar")  # 添加Condition列
  }),
  
  map_dfr(df_Self_Mother, ~{
    df_temp <- as.data.frame(.x)  # 将列表转换为数据框
    mutate(df_temp, Condition = "Self-Mother")  # 添加Condition列
  }),
  
  map_dfr(df_Self_Acquaintance, ~{
    df_temp <- as.data.frame(.x)  # 将列表转换为数据框
    mutate(df_temp, Condition = "Self-Acquaintance")  # 添加Condition列
  }),
  
  # map_dfr(df_Self_Others, ~{
  #   df_temp <- as.data.frame(.x)  # 将列表转换为数据框
  #   mutate(df_temp, Condition = "Self-Others")  # 添加Condition列
  # }),
  
  map_dfr(df_Self_Friend, ~{
    df_temp <- as.data.frame(.x)  # 将列表转换为数据框
    mutate(df_temp, Condition = "Self-Friend")  # 添加Condition列
  })
)

# 查看合并后的数据框
head(df_combined)

```

## 探索1
```{r}
# 将列表转换为数据框并添加Condition列
df_combined <- bind_rows(
  map_dfr(df_Self_Stranger, ~{
    df_temp <- as.data.frame(.x)  # 将列表转换为数据框
    mutate(df_temp, Condition = "Self-Stranger")  # 添加Condition列
  }),
  
  map_dfr(df_Self_Familiar, ~{
    df_temp <- as.data.frame(.x)  # 将列表转换为数据框
    mutate(df_temp, Condition = "Self-Familiar")  # 添加Condition列
  }),
  
  map_dfr(df_Self_Mother, ~{
    df_temp <- as.data.frame(.x)  # 将列表转换为数据框
    mutate(df_temp, Condition = "Self-Familiar")  # 添加Condition列
  }),
  
  map_dfr(df_Self_Acquaintance, ~{
    df_temp <- as.data.frame(.x)  # 将列表转换为数据框
    mutate(df_temp, Condition = "Self-Familiar")  # 添加Condition列
  }),
  
  # map_dfr(df_Self_Others, ~{
  #   df_temp <- as.data.frame(.x)  # 将列表转换为数据框
  #   mutate(df_temp, Condition = "Self-Others")  # 添加Condition列
  # }),
  
  map_dfr(df_Self_Friend, ~{
    df_temp <- as.data.frame(.x)  # 将列表转换为数据框
    mutate(df_temp, Condition = "Self-Familiar")  # 添加Condition列
  })
)

# 查看合并后的数据框
head(df_combined)

```

```{r}
# 画 Cohen's d for RT
ggplot(df_combined, aes(x = Condition, y = Cohens_d_RT, color = Condition, fill = Condition)) +
  geom_violin(trim = FALSE, alpha = 0.6, position = position_dodge(width = 0.8)) +  # dodge to avoid overlap
  geom_jitter(size = 2, shape = 16, color = "black", position = position_dodge(width = 0.8)) +  # dodge for jitter as well
  theme_minimal() +
  labs(title = "Cohen's d for RT", y = "Cohen's d", x = "Condition") +
  theme(legend.position = "right") +  # 显示图例
  theme(plot.title = element_text(hjust = 0.5))

# 画 Cohen's d for ACC
ggplot(df_combined, aes(x = Condition, y = Cohens_d_ACC, color = Condition, fill = Condition)) +
  geom_violin(trim = FALSE, alpha = 0.6, position = position_dodge(width = 0.8)) +  # dodge to avoid overlap
  geom_jitter(size = 2, shape = 16, color = "black", position = position_dodge(width = 0.8)) +  # dodge for jitter as well
  theme_minimal() +
  labs(title = "Cohen's d for ACC", y = "Cohen's d", x = "Condition") +
  theme(legend.position = "right") +  # 显示图例
  theme(plot.title = element_text(hjust = 0.5))


```

```{r}
library(ggplot2)

# 画 Cohen's d for RT
ggplot(df_combined, aes(x = Condition, y = Cohens_d_RT, fill = Condition)) +
  geom_violin(trim = FALSE, alpha = 0.5) +  # 小提琴图，透明度设置为 0.5
  geom_boxplot(width = 0.1, outlier.shape = NA, color = "black") +  # 中间的箱线图，去除离群点
  geom_jitter(width = 0.2, size = 1.5, alpha = 0.5, color = "darkblue") +  # 散点图，轻微抖动，透明度 0.3
  theme_minimal() +
  labs(title = "Cohen's d for RT", y = "Cohen's d", x = "Condition") +
  theme(legend.position = "none") +  # 隐藏图例
  theme(plot.title = element_text(hjust = 0.5)) +
  scale_fill_manual(values = c("Self-Stranger" = "orange", "Self-Familiar" = "yellow"))  # 自定义颜色

# 画 Cohen's d for ACC
ggplot(df_combined, aes(x = Condition, y = Cohens_d_ACC, fill = Condition)) +
  geom_violin(trim = FALSE, alpha = 0.5) +  # 小提琴图，透明度设置为 0.5
  geom_boxplot(width = 0.1, outlier.shape = NA, color = "black") +  # 中间的箱线图，去除离群点
  geom_jitter(width = 0.2, size = 1.5, alpha = 0.3, color = "darkgreen") +  # 散点图，轻微抖动，透明度 0.3
  theme_minimal() +
  labs(title = "Cohen's d for ACC", y = "Cohen's d", x = "Condition") +
  theme(legend.position = "none") +  # 隐藏图例
  theme(plot.title = element_text(hjust = 0.5)) +
  scale_fill_manual(values = c("Self-Stranger" = "lightgreen", "Self-Familiar" = "lightyellow"))  # 自定义颜色

```

```{r}
# 画 Cohen's d for RT
ggplot(df_combined, aes(x = Condition, y = Cohens_d_RT, color = Condition)) +
  geom_violin(trim = FALSE,fill = "lightblue", alpha = 0.6) +  # 小提琴图，透明度设置为 0.5
  geom_violin(trim = FALSE, alpha = 0.5, draw_quantiles = c(0.5)) +  # 小提琴图显示一半
  geom_boxplot(width = 0.1, outlier.shape = NA, color = "black") +  # 中间的箱线图，去除离群点
  geom_jitter(width = 0.2, size = 1.5, alpha = 0.5, color = "darkblue") +  # 散点图，轻微抖动，透明度 0.3
  theme_minimal() +

  # geom_violin(trim = FALSE, fill = "lightblue", alpha = 0.6) +
  # geom_jitter(width = 0.1, size = 2, shape = 16, color = "darkblue") +
  # theme_minimal() +
  labs(title = "Cohen's d for RT", y = "Cohen's d", x = "Condition") +
  theme(legend.position = "none") +
  theme(plot.title = element_text(hjust = 0.5)) +
  facet_wrap(~Condition)  # 按Condition分面

```


```{r}
library(ggplot2)

# 画 Cohen's d for RT
ggplot(df_combined, aes(x = Condition, y = Cohens_d_RT, fill = Condition)) +
  geom_violin(trim = FALSE, alpha = 0.5, draw_quantiles = c(0.5)) +  # 小提琴图显示一半
  geom_boxplot(width = 0.1, outlier.shape = NA, color = "black") +  # 中间的箱线图
  geom_jitter(width = 0.2, size = 1.5, alpha = 0.3, color = "darkblue") +  # 散点图
  theme_minimal() +
  labs(title = "Cohen's d for RT", y = "Cohen's d", x = "Condition") +
  theme(legend.position = "none") +  # 隐藏图例
  theme(plot.title = element_text(hjust = 0.5)) +
  scale_fill_manual(values = c("Self-Stranger" = "orange", "Self-Familiar" = "yellow")) +
  coord_cartesian(clip = "off") +  # 防止绘图区域裁剪掉小提琴图的一部分
  theme(axis.text.x = element_text(hjust = 0.5))  # 调整x轴标签位置

# 画 Cohen's d for ACC
ggplot(df_combined, aes(x = Condition, y = Cohens_d_ACC, fill = Condition)) +
  geom_violin(trim = FALSE, alpha = 0.5, draw_quantiles = c(0.5)) +  # 小提琴图显示一半
  geom_boxplot(width = 0.1, outlier.shape = NA, color = "black") +  # 中间的箱线图
  geom_jitter(width = 0.2, size = 1.5, alpha = 0.3, color = "darkgreen") +  # 散点图
  theme_minimal() +
  labs(title = "Cohen's d for ACC", y = "Cohen's d", x = "Condition") +
  theme(legend.position = "none") +  # 隐藏图例
  theme(plot.title = element_text(hjust = 0.5)) +
  scale_fill_manual(values = c("Self-Stranger" = "lightgreen", "Self-Familiar" = "lightyellow")) +
  coord_cartesian(clip = "off") +  # 防止绘图区域裁剪掉小提琴图的一部分
  theme(axis.text.x = element_text(hjust = 0.5))  # 调整x轴标签位置

```










# Cohens d
```{r}
# 画 Cohen's d for RT
ggplot(df_combined, aes(x = Condition, y = Cohens_d_RT, color = Condition)) +
  geom_violin(trim = FALSE, fill = "lightblue", alpha = 0.6) +
  geom_jitter(width = 0.1, size = 2, shape = 16, color = "darkblue") +
  theme_minimal() +
  labs(title = "Cohen's d for RT", y = "Cohen's d", x = "Condition") +
  theme(legend.position = "none") +
  theme(plot.title = element_text(hjust = 0.5))

# 画 Cohen's d for ACC
ggplot(df_combined, aes(x = Condition, y = Cohens_d_ACC, color = Condition)) +
  geom_violin(trim = FALSE, fill = "lightgreen", alpha = 0.6) +
  geom_jitter(width = 0.1, size = 2, shape = 16, color = "darkgreen") +
  theme_minimal() +
  labs(title = "Cohen's d for ACC", y = "Cohen's d", x = "Condition") +
  theme(legend.position = "none") +
  theme(plot.title = element_text(hjust = 0.5))

```

# Δ
```{r}
# 画 deta_RT
ggplot(df_combined, aes(x = Condition, y = deta_RT, color = Condition)) +
  geom_violin(trim = FALSE, fill = "lightblue", alpha = 0.6) +
  geom_jitter(width = 0.1, size = 2, shape = 16, color = "darkblue") +
  theme_minimal() +
  labs(title = "deta_RT", y = "deta_RT", x = "Condition") +
  theme(legend.position = "none") +
  theme(plot.title = element_text(hjust = 0.5))

# 画 deta_ACC
ggplot(df_combined, aes(x = Condition, y = deta_ACC, color = Condition)) +
  geom_violin(trim = FALSE, fill = "darkgreen", alpha = 0.6) +
  geom_jitter(width = 0.1, size = 2, shape = 16, color = "lightgreen") +
  theme_minimal() +
  labs(title = "deta_ACC", y = "deta_ACC", x = "Condition") +
  theme(legend.position = "none") +
  theme(plot.title = element_text(hjust = 0.5))
```

